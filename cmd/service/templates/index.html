<!DOCTYPE html>
<html>
  <head>
    <title>McDuck</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="assets/styles.css" />
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  </head>
  <header>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </header>
  <body>
    <div class="navbar">
      <nav>
        <ul>
          <li><a href="/">Dashboard</a></li>
          <li><a href="/about">About</a></li>
        </ul>
      </nav>
    </div>
    <div>
      <h1>Expense Report</h1>
    </div>
    <div>
      <div>
        <form action="/upload" method="post" enctype="multipart/form-data">
          Files: <input type="file" name="files" multiple /><br /><br />
          <input type="submit" value="Submit" />
        </form>
      </div>
      <div>
        <div style="display: flex">
          <div class="chart" style="width: 50%">
            <h2>Expenses per category this month</h2>
            <canvas id="categoriesChart"></canvas>
          </div>
          <div class="chart" style="width: 50%">
            <h2>Expenses per sub-category this month</h2>
            <canvas id="subcategoriesChart"></canvas>
          </div>
        </div>
        <div class="chart">
          <h2>MoM expenses per category</h2>
          <canvas id="momChart"></canvas>
        </div>
      </div>
    </div>
  </body>
  <script>
    const monthNames = ["January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];

    const thisMonth = monthNames[new Date().getMonth()] + " " + new Date().getFullYear()

    Chart.defaults.font.familty = "monospace";
    Chart.defaults.font.size = 15;
    let labels = {{.Categories}};
    let amounts = {{.CategoryAmounts}};

    let data = {
      labels: labels,
      datasets: [
        {
          label: thisMonth,
          data: amounts,
          backgroundColor: [
            "rgba(255, 99, 132, 0.2)",
            "rgba(255, 159, 64, 0.2)",
            "rgba(255, 205, 86, 0.2)",
            "rgba(75, 192, 192, 0.2)",
            "rgba(54, 162, 235, 0.2)",
            "rgba(153, 102, 255, 0.2)",
            "rgba(201, 203, 207, 0.2)",
          ],
          borderColor: [
            "rgb(255, 99, 132)",
            "rgb(255, 159, 64)",
            "rgb(255, 205, 86)",
            "rgb(75, 192, 192)",
            "rgb(54, 162, 235)",
            "rgb(153, 102, 255)",
            "rgb(201, 203, 207)",
          ],
          borderWidth: 1,
        },
      ],
    };

    let config = {
      type: "bar",
      data: data,
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
      },
    };
    let myChart = new Chart(
      document.getElementById("categoriesChart"),
      config
    );
  </script>
  <script>
    labels = {{.SubCategories}};
    amounts = {{.SubCategoryAmounts}};

    data = {
      labels: labels,
      datasets: [
        {
          label: thisMonth,
          data: amounts,
          backgroundColor: [
            "rgba(255, 99, 132, 0.2)",
            "rgba(255, 159, 64, 0.2)",
            "rgba(255, 205, 86, 0.2)",
            "rgba(75, 192, 192, 0.2)",
            "rgba(54, 162, 235, 0.2)",
            "rgba(153, 102, 255, 0.2)",
            "rgba(201, 203, 207, 0.2)",
          ],
          borderColor: [
            "rgb(255, 99, 132)",
            "rgb(255, 159, 64)",
            "rgb(255, 205, 86)",
            "rgb(75, 192, 192)",
            "rgb(54, 162, 235)",
            "rgb(153, 102, 255)",
            "rgb(201, 203, 207)",
          ],
          borderWidth: 1,
        },
      ],
    };

    config = {
      type: "bar",
      data: data,
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
      },
    };
    myChart = new Chart(
      document.getElementById("subcategoriesChart"),
      config
    );
  </script>
  <script>
    labels = {{.MOMLabels}};
    amounts = {{.MOMData}};

    const datasets = [];
    {{range $category, $dataset := .MOMData}}
      datasets.push({
        label: {{$category}},
        data: {{$dataset}},
        fill: false,
        borderColor: `rgb(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255})`,
        tension: 0.1,
      })
    {{end}}

    data = {
      labels: labels,
      datasets: datasets,
    };

    config = {
      type: "line",
      data: data,
    };
    myChart = new Chart(
      document.getElementById("momChart"),
      config
    );
  </script>
</html>
